# 置換定理

: (1)式のパラメータ$a_i$の任意の置換によって得られる連立確率漸化式の解$p^{(d)}_t$はすべて等しい.

$$
\left\{
\begin{aligned}
p^{(0)}_{t+1} &= \left( 1- \frac{a_0}{S-t} \right) p^{(0)}_t & p^{(0)}_0 &= 1 \\
p^{(i)}_{t+1} &= \left( 1- \frac{a_i}{S-t} \right) p^{(i)}_t + \frac{a_{i-1}}{S-t} p^{(i-1)}_t & p^{(i)}_0 &= 0 & (0 \le i < d) \\
p^{(d)}_{t+1} &= \frac{a_{d-1}}{S-t} p^{(d-1)}_t + p^{(d)}_{t} & p^{(d)}_0 &= 0
\end{aligned}
\right.
\tag{1}
$$

$d \ge 2$の場合について数学的帰納法によって示す.

$d = 2$のとき(1)式は以下のようになる.

$$
\left\{
\begin{aligned}
p^{(0)}_{t+1} &= \left( 1- \frac{a_0}{S-t} \right) p^{(0)}_t & p^{(0)}_0 &= 1 \\
p^{(1)}_{t+1} &= \left( 1- \frac{a_1}{S-t} \right) p^{(1)}_t + \frac{a_0}{S-t} p^{(0)}_t & p^{(1)}_0 &= 0 \\
p^{(2)}_{t+1} &= \frac{a_1}{S-t} p^{(1)}_t + p^{(2)}_{t} & p^{(2)}_0 &= 0
\end{aligned}
\right.
\tag{2}
$$

ここで以下の変数を導入する.

$$
\left\{
\begin{aligned}
q^{(0)}_t &= \frac{a_0 a_1}{(S-t)(S-t-1)}p^{(0)}_t \\
q^{(1)}_t &= \frac{a_1}{S-t}p^{(1)}_t \\
\end{aligned}
\right.
$$

これらは次の連立漸化式を満たす.

$$
\left\{
\begin{aligned}
q^{(0)}_{t+1} &= \frac{S-t-a_0}{S-t-2}q^{(0)}_t & q^{(0)}_0 &= \frac{a_0 a_1}{S(S-1)} \\
q^{(1)}_{t+1} &= \frac{S-t-a_1}{S-t-1}q^{(1)}_t + q^{(0)}_t & q^{(1)}_0 &= 0 \\
p^{(2)}_{t+1} &= q^{(1)}_t + p^{(2)}_t & p^{(2)}_0 &= 0
\end{aligned}
\right.
\tag{3}
$$

これを$q^{(1)}_t$について解くと,

$$
q^{(1)}_{t+2} - \frac{(S-t-a_0)+(S-t-a_1)-1}{S-t-2}q^{(1)}_{t+1} + \frac{(S-t-a_0)(S-t-a_1)}{(S-t-1)(S-t-2)}q^{(1)}_t = 0
\tag{4}
$$

が得られる. (4)式は$q^{(1)}_t$についての漸化式であると同時に$a_0, a_1$の対称式になっている. $q^{(1)}_0, q^{(1)}_1$も$a_0, a_1$の対称式であるから, すべての$t$について$q^{(1)}_t$および$p^{(2)}_t$は$a_0, a_1$の対称式となる. よって$d = 2$のとき題意は成り立つ.

$d = k \ (k \ge 2)$のとき題意が成り立つと仮定し, $d = k+1$のときを議論する. まず$p^{(k+1)}_t$が$a_k, a_{k-1}$についての対称式となることを示す. 以下の変数を導入する.

$$
\left\{
\begin{aligned}
q^{(k-1)}_t &= \frac{a_{k-1} a_k}{(S-t)(S-t-1)}p^{(k-1)}_t \\
q^{(k)}_t &= \frac{a_k}{S-t}p^{(k)}_t \\
\end{aligned}
\right.
$$

これらは次の連立漸化式を満たす.

$$
\left\{
\begin{aligned}
q^{(k-1)}_{t+1} &= \frac{S-t-a_{k-1}}{S-t-2}q^{(k-1)}_t + \frac{a_{k-2} a_{k-1} a_k}{(S-t)(S-t-1)(S-t-2)}p^{(k-2)}_t & q^{(k-1)}_0 &= \frac{a_{k-1} a_k}{S(S-1)} \\
q^{(k)}_{t+1} &= \frac{S-t-a_k}{S-t-1}q^{(k)}_t + q^{(k-1)}_t & q^{(k)}_0 &= 0 \\
p^{(k+1)}_{t+1} &= q^{(k)}_t + p^{(k+1)}_t & p^{(k+1)}_0 &= 0
\end{aligned}
\right.
\tag{5}
$$

これを$q^{(k)}_t$について解くと,

$$
q^{(k)}_{t+2} - \frac{(S-t-a_{k-1})+(S-t-a_k)-1}{S-t-2}q^{(k)}_{t+1} + \frac{(S-t-a_{k-1})(S-t-a_k)}{(S-t-1)(S-t-2)}q^{(k)}_t - \frac{a_{k-2} a_{k-1} a_{k}}{(S-t)(S-t-1)(S-t-2)}p^{(k-2)}_t = 0
\tag{6}
$$

が得られる. $p^{(k-2)}_t$は$a_{k-1}, a_k$には依存しないから(6)式は$a_k, a_{k-1}$についての対称式である. $q^{(k)}_0, q^{(k)}_1$も$a_{k-1}, a_k$の対称式であるから, すべての$t$について$q^{(k)}_t$および$p^{(k+1)}_t$は$a_{k-1}, a_k$の対称式となる.

次に$a^{(i)} \ (0 \le i \le k)$の任意の置換について議論する. $a_{k-1}, a_k$の置換と$a_i \ (0 \le i \le k-1)$の置換を組み合わせることで$a_i \ (0 \le i \le k)$の任意の置換を生成することができる. 加えて, $a_{k-1}, a_k$の置換で得られる解が元の解と等しいこと, および仮定より$a_i \ (0 \le i \le k)$の任意の置換によって得られる連立確率漸化式の解はすべて等しい. よって$d = k+1$のとき題意は成り立つ.

以上の議論により任意の$d$について題意は成り立つ.
